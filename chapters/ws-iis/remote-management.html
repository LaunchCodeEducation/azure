<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>10.3. Remote Management With Windows Server &#8212; Microsoft Azure  documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/fa/css/all.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/launchcode.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/site.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="10.4. Walkthrough: Windows Server &amp; IIS Starter App Deployment" href="walkthrough_ws-iis.html" />
    <link rel="prev" title="10.2. Introduction to Web Servers &amp; IIS" href="iis.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body class="body-bc">

<div id="navbar" class="navbar navbar-default navbar-fixed-top">
   <div class="container">
     <div class="navbar-header">
       <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
       <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
         <span class="icon-bar"></span>
         <span class="icon-bar"></span>
         <span class="icon-bar"></span>
       </button>
       <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/lc-ed-logo.png" alt="LaunchCode logo"></span>
       </a>
       <span class="navbar-text navbar-version pull-left"><b></b></span>
     </div>

       <div class="collapse navbar-collapse nav-collapse">
         <ul class="nav navbar-nav">
           
           
             
           
           
           
           
           
         </ul>

         
           
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
    <label for="q" class="searchLabel">Search</label>
    <input type="text" name="q" class="form-control" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
         
       </div>
   </div>
 </div>

<ol class="breadcrumb container">
    <li><a href="../../index.html">Contents</a></li>
    <li><a href="index.html">10. Windows Server &amp; IIS</a></li>
    <li class="active">10.3. Remote Management With Windows Server</li>
</ol>



<div class="container">
  <div class="row">
    <div class="col-md-10 col-md-offset-1 content ">

    
  <div class="section" id="remote-management-with-windows-server">
<span id="remote-management"></span><h1>10.3. Remote Management With Windows Server<a class="headerlink" href="#remote-management-with-windows-server" title="Permalink to this headline">¶</a></h1>
<p>Remote management is the practice of accessing and managing a (remote) machine from another (local) machine. For consumers, remote management (RM) is often used by help desk professionals to troubleshoot issues by controlling the client’s PC instead of relaying instructions over the phone. In our context, we use RM to manage our servers which, being virtual, can never be accessed physically.</p>
<p>So far, you have experienced a simplistic form of RM using the Azure web portal’s RunCommand console. Although the RunCommand console was convenient for us to interact with our Ubuntu VM, it is not commonly, if ever, used by professionals due to its inherent limitations. As you likely noticed, the RunCommand console is browser-based, slow, and only able to send commands and print their outputs one at a time. In order to effectively configure and troubleshoot our VMs we need more robust RM tooling.</p>
<div class="section" id="azure-cli-runcommand">
<h2>10.3.1. Azure CLI RunCommand<a class="headerlink" href="#azure-cli-runcommand" title="Permalink to this headline">¶</a></h2>
<p>Recall that both the Azure CLI and the web portal GUI are backed by the same REST API. We have also learned that working from the command-line offers greater portability and automation capability relative to using a browser-based GUI. With the <code class="docutils literal notranslate"><span class="pre">az</span> <span class="pre">CLI</span></code> we are able to use the same RunCommand we experienced in the browser but with all of the benefits of the command-line.</p>
<div class="admonition-tip admonition">
<p class="first admonition-title"><i class="fas fa-lightbulb" aria-hidden="true"></i>Tip</p>
<p class="last">Unlike the browser console, you can use the <code class="docutils literal notranslate"><span class="pre">az</span> <span class="pre">CLI</span></code> to issue RunCommands to <em>multiple machines at once</em> using their resource IDs (VM identities)!</p>
</div>
<p>Within the Azure CLI the <code class="docutils literal notranslate"><span class="pre">vm</span></code> sub-group <code class="docutils literal notranslate"><span class="pre">run-command</span></code> can be used to toggle commonly used machine settings or execute complete scripts remotely. Every RunCommand has a unique name known as its <code class="docutils literal notranslate"><span class="pre">command-id</span></code> which you can view using <code class="docutils literal notranslate"><span class="pre">list</span></code>:</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">assumes the default location has been configured</span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="p">&gt;</span> <span class="n">az</span> <span class="n">vm</span> <span class="n">run-command</span> <span class="n">list</span>

<span class="c"># concise table output using a JMESPath query</span>
<span class="p">&gt;</span> <span class="n">az</span> <span class="n">vm</span> <span class="n">run-command</span> <span class="n">list</span> <span class="p">-</span><span class="n">-query</span> <span class="s2">&quot;[].{ commandId: id, label: label }&quot;</span> <span class="n">-o</span> <span class="n">table</span>
</pre></div>
</div>
</div>
<p>To issue a RunCommand use the <code class="docutils literal notranslate"><span class="pre">invoke</span></code> Command:</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">assumes a default RG, location and VM have been configured</span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="p">&gt;</span> <span class="n">az</span> <span class="n">vm</span> <span class="n">run-command</span> <span class="n">invoke</span> <span class="p">-</span><span class="n">-command-id</span> <span class="p">&lt;</span><span class="n">command</span> <span class="n">ID</span><span class="p">&gt;</span>
</pre></div>
</div>
</div>
<p>There are several RunCommand commands that perform pre-defined actions on the remote machine. However, you will often want to run custom scripts or individual shell commands directly. To execute scripts remotely, you can use the <code class="docutils literal notranslate"><span class="pre">RunPowerShellScript</span></code> and <code class="docutils literal notranslate"><span class="pre">RunShellScript</span></code> command IDs for Windows and Linux VMs respectively.</p>
<p>Using these RunCommand commands is the command-line equivalent of pasting the script into the RunCommand console in the browser. You can run any number of scripts using the <code class="docutils literal notranslate"><span class="pre">--scripts</span></code> argument. These can be individual shell commands enclosed in quotes or file path references to pre-written scripts on your local machine.</p>
<div class="admonition-tip admonition">
<p class="first admonition-title"><i class="fas fa-lightbulb" aria-hidden="true"></i>Tip</p>
<p class="last">For Windows VMs, you should use <code class="docutils literal notranslate"><span class="pre">RunPowerShellScript</span></code> and for Linux VMs use <code class="docutils literal notranslate"><span class="pre">RunShellScript</span></code>. Note that <em>this is in reference to the remote VM you are interacting with</em>, not the OS of your local machine that is issuing the RunCommand.</p>
</div>
<p>Here is an example of issuing single shell commands that simply list files in the home directory of the VM. For Windows, we use the PowerShell <code class="docutils literal notranslate"><span class="pre">Get-ChildItem</span></code> command, and for Linux, its Bash equivalent, <code class="docutils literal notranslate"><span class="pre">ls</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">assumes a default RG, location and VM have been configured</span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># for a Windows VM run a PowerShell script (uses PowerShell in the VM)</span>
<span class="p">&gt;</span> <span class="n">az</span> <span class="n">vm</span> <span class="n">run-command</span> <span class="n">invoke</span> <span class="p">-</span><span class="n">-command-id</span> <span class="n">RunPowerShellScript</span> <span class="p">-</span><span class="n">-scripts</span> <span class="s2">&quot;Get-ChildItem&quot;</span>

<span class="c"># for a Linux VM run a Shell script (uses the default shell of the VM, usually Bash)</span>
<span class="p">&gt;</span> <span class="n">az</span> <span class="n">vm</span> <span class="n">run-command</span> <span class="n">invoke</span> <span class="p">-</span><span class="n">-command-id</span> <span class="n">RunShellScript</span> <span class="p">-</span><span class="n">-scripts</span> <span class="s2">&quot;ls&quot;</span>
</pre></div>
</div>
</div>
<p>For longer scripts, you will want to reference pre-written script files on your local machine. You can do this using the <code class="docutils literal notranslate"><span class="pre">&#64;/path/to/script</span></code> syntax.</p>
<p>Here is an example that uses a script file located in the home (<code class="docutils literal notranslate"><span class="pre">~</span></code>) directory called <code class="docutils literal notranslate"><span class="pre">myscript.&lt;ext&gt;</span></code> with the appropriate extension for PowerShell or Bash corresponding to the CLI shell of the remote VM.</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">assumes a default RG, location and VM have been configured</span><a class="headerlink" href="#id4" title="Permalink to this code">¶</a></div>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># myscript.ps is a PowerShell script</span>
<span class="p">&gt;</span> <span class="n">az</span> <span class="n">vm</span> <span class="n">run-command</span> <span class="n">invoke</span> <span class="p">-</span><span class="n">-command-id</span> <span class="n">RunPowerShellScript</span> <span class="p">-</span><span class="n">-scripts</span> <span class="p">@</span><span class="s2">&quot;~/myscript.ps&quot;</span>

<span class="c"># myscript.sh is a Bash script</span>
<span class="p">&gt;</span> <span class="n">az</span> <span class="n">vm</span> <span class="n">run-command</span> <span class="n">invoke</span> <span class="p">-</span><span class="n">-command-id</span> <span class="n">RunShellScript</span> <span class="p">-</span><span class="n">-scripts</span> <span class="p">@</span><span class="s2">&quot;~/myscript.sh&quot;</span>
</pre></div>
</div>
</div>
<p>After invoking the script, it will output information about the result. By default the <code class="docutils literal notranslate"><span class="pre">message</span></code> property of the output object will show the <code class="docutils literal notranslate"><span class="pre">stdout</span></code> and <code class="docutils literal notranslate"><span class="pre">stderr</span></code> with newline characters (<code class="docutils literal notranslate"><span class="pre">\n</span></code>) between them.</p>
<p>One thing to keep in mind is that RunCommand is just as slow from the command-line as it is in the browser console. It can still be useful for executing on multiple machines at once, but it is more common to use the other remote management mechanisms discussed below.</p>
</div>
<div class="section" id="remote-desktop-protocol">
<h2>10.3.2. Remote Desktop Protocol<a class="headerlink" href="#remote-desktop-protocol" title="Permalink to this headline">¶</a></h2>
<p id="index-0">The <strong>Remote Desktop Protocol</strong> (RDP) is a protocol developed by Microsoft for accessing the GUI desktop of a remote Windows machine. The remote machine can be physical or virtual, but in our case we will always use RDP with Windows Server VMs. Instead of interacting with the machine using the command line, you can use the VM as if it were right in front of you!</p>
<p>RDP is often used by technical support staff to help enterprise and consumer customers debug issues on their machines. But RDP is great for DevOps engineers to troubleshoot and configure things manually where a full desktop experience is preferred.</p>
<div class="admonition-fun-fact admonition">
<p class="first admonition-title"><i class="fas fa-rocket" aria-hidden="true"></i>Fun Fact</p>
<p class="last">RDP is used as both a noun, referring to the protocol itself, and as a verb, referring to the act of “RDP-ing into a machine”!</p>
</div>
<div class="section" id="mstsc">
<h3>10.3.2.1. MSTSC<a class="headerlink" href="#mstsc" title="Permalink to this headline">¶</a></h3>
<p id="index-1">Windows provides the <code class="docutils literal notranslate"><span class="pre">mstsc</span></code> command-line utility for creating an RDP session between your local and remote machine. Opening an RDP session is very simple and only requires the public IP address of the VM and the login credentials.</p>
<p>Here is the general form of using <code class="docutils literal notranslate"><span class="pre">mstsc</span></code>:</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">mstsc is available on Windows machines</span><a class="headerlink" href="#id5" title="Permalink to this code">¶</a></div>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span>&gt; mstsc /v:&lt;public IP address&gt;
</pre></div>
</div>
</div>
<p>This will prompt you for a username and password to access the VM. Once those are entered, a new window will appear that provides the full desktop GUI of the remote machine. We will get to practice using RDP in the upcoming exercises.</p>
<div class="admonition-note admonition">
<p class="first admonition-title"><i class="fas fa-sticky-note" aria-hidden="true"></i>Note</p>
<p class="last">Desktop access over RDP inherently requires the VM to have the desktop GUI shell installed. If the VM is using the Windows Server Core OS then only a PowerShell terminal is presented during an RDP session.</p>
</div>
</div>
<div class="section" id="jump-boxes">
<h3>10.3.2.2. Jump Boxes<a class="headerlink" href="#jump-boxes" title="Permalink to this headline">¶</a></h3>
<p>One common use case for RDP is to securely access machines that exist within a protected corporate network. In order to protect production machines, their network and firewall configurations are locked down to only accept connections using the private IP addresses of machines that are connected to their protected network.</p>
<p id="index-2">In addition to the production servers, a small number of VMs, called <strong>jump boxes</strong> or <strong>jump servers</strong>, are given public IP addresses and RDP access. Jump boxes bridge the gap between the public Internet (where your local machine lives) and the private network (where production servers live). These operational machines allow you to connect from your local machine to the jump box and then <em>jump</em> to access the protected machines within the private network. You can think of the jump box like a middle man between the developer’s local machine and the protected machines.</p>
<p>For security reasons, jump boxes are configured to expose RDP access only to developers of the company by using an IP address whitelist, VPN tunneling, or other more complex patterns. Once you have RDP’d into the jump box, it behaves as if you are using a desktop from within the private network. From there, you can access protected machines using RDP or one of the other remote access mechanisms.</p>
<img alt="Remote connection to a VM via a jump box" src="../../_images/rdp.png" />
<p>This strategy minimizes the <em>exposed network area</em> of the infrastructure much like the slimmed Windows Server OS minimizes the <em>exposed software area</em> for potential attacks. Instead of having to worry about <em>all of the machines</em> having public IP addresses and RDP access, only a few jump boxes are exposed. Often, these boxes are started and stopped on demand to further restrict their usage. From these minimal entry points to the system, the access between the local machine, jump boxes, and production machines can be carefully restricted, monitored, and logged.</p>
</div>
</div>
<div class="section" id="remote-powershell-with-winrm">
<h2>10.3.3. Remote PowerShell With WinRM<a class="headerlink" href="#remote-powershell-with-winrm" title="Permalink to this headline">¶</a></h2>
<p>Sometimes it is beneficial to manage servers headlessly. As we learned in our previous lessons, the power of direct OS access and scripted automation makes command-line management an attractive option. Although the <code class="docutils literal notranslate"><span class="pre">az</span> <span class="pre">CLI</span></code> offers command-line access with RunCommand, it is slow and not suitable for automated scripting or troubleshooting. RDP is natural to use with its full desktop interface, but there are times where entering individual VMs and navigating the GUI in this way is inefficient.</p>
<p>Instead, there is a set of Windows-exclusive tools that allow you to work with a machine efficiently through the PowerShell terminal. Remote PowerShell Sessions (PS-Sessions) are a command-line hybrid of both RDP and the <code class="docutils literal notranslate"><span class="pre">az</span> <span class="pre">CLI</span></code> RunCommand. But instead of working in a desktop GUI, or using the Azure REST API as a slow middle-man, it transfers commands and outputs to and from a local and remote machine’s CLI shells in near real-time.</p>
<p>A session can be used to invoke individual commands using the cmdlet <code class="docutils literal notranslate"><span class="pre">Invoke-Command</span></code> or to enter an interactive session using <code class="docutils literal notranslate"><span class="pre">Enter-PSSession</span></code>. The first cmdlet, <code class="docutils literal notranslate"><span class="pre">Invoke-Command</span></code>, is very similar to RunCommand but is both faster and more configurable. While <code class="docutils literal notranslate"><span class="pre">Enter-PSSession</span></code> is the command-line equivalent of RDP. Both of these tools are built on top of Windows Remote Management (WinRM).</p>
<p id="index-3"><strong>Windows Remote Management</strong> (WinRM) is the Microsoft implementation of WS-Management Protocol, a standard SOAP-based protocol that allows for headless remote management.</p>
<div class="admonition-note admonition">
<p class="first admonition-title"><i class="fas fa-sticky-note" aria-hidden="true"></i>Note</p>
<p>Unfortunately, in this class we will not be using PS-Session cmdlets due to their OS requirements. WinRM based tooling is not available on Windows 10 Home Edition. It requires Windows Server or a PC running Windows 10 Enterprise, Professional, or Education editions.</p>
<p class="last">However, they are important tools for gaining access to remote Windows machines and you will use them in your career moving forward. For this reason, it is important to at least gain a conceptual understanding of how they work.</p>
</div>
<p>Remote PowerShell Sessions (RPS) are connections formed between a host and client machine. The client machine is the one initiating the session, like your local machine, while the host would be a remote VM you are trying to access. Just as RDP gives you desktop GUI shell access, the <code class="docutils literal notranslate"><span class="pre">PS-Session</span></code> gives you PowerShell CLI shell access. We will go over the essentials in this article, but for more information take a look at this <a class="reference external" href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_pssessions?view=powershell-7" target="_blank">deep-dive article<i class="fas fa-external-link-alt" aria-hidden="true"></i></a>.</p>
<div class="section" id="new-pssession">
<h3>10.3.3.1. New-PSSession<a class="headerlink" href="#new-pssession" title="Permalink to this headline">¶</a></h3>
<p>After enabling RPS access on the remote (host) machine you can open a session using <code class="docutils literal notranslate"><span class="pre">New-PSSession</span></code>.</p>
<div class="admonition-warning admonition">
<p class="first admonition-title"><i class="fas fa-exclamation-triangle" aria-hidden="true"></i>Warning</p>
<p class="last">In order to use <code class="docutils literal notranslate"><span class="pre">New-PSSession</span></code> and the other PSSession related cmdlets <em>you must be using Windows 10 Pro, Enterprise, or Education</em> editions as they all come pre-installed with the Hyper-V Module dependency. This module is not available for download and cannot be installed on Windows 10 Home, as the tool was not created for consumer PCs.</p>
</div>
<p>Here is the most basic example that requires a VM’s global identifier. The output of running this cmdlet will be a Session ID which we store in a variable for use with the related cmdlets:</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">Windows/PowerShell</span><a class="headerlink" href="#id6" title="Permalink to this code">¶</a></div>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="p">&gt;</span> <span class="nv">$SessionId</span><span class="p">=</span><span class="nb">New-PSSession</span> <span class="n">-VMId</span> <span class="n">484155ab-b52b</span><span class="p">-</span><span class="n">4d554-akk7f1540e80</span>
</pre></div>
</div>
</div>
<p>If you were to run this command, you would be asked for credentials (username, and password for the VM) and then granted access by creating a PowerShell session with the remote machine. There are numerous ways of forming the initial session which you can read more about in <a class="reference external" href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/new-pssession?view=powershell-7" target="_blank">this documentation article<i class="fas fa-external-link-alt" aria-hidden="true"></i></a>.</p>
</div>
<div class="section" id="enter-pssession">
<h3>10.3.3.2. Enter-PSSession<a class="headerlink" href="#enter-pssession" title="Permalink to this headline">¶</a></h3>
<p>Once a session has been created you can begin an interactive mode to gain access to a PowerShell REPL with the other machine. Within this session, commands you enter are transmitted to the remote machine and outputs are transmitted back locally. Effectively, it is as if you are working in the PowerShell terminal of the remote host machine.</p>
<p>You can enter a PS Session using the <code class="docutils literal notranslate"><span class="pre">Enter-PSSession</span></code> command and supplying it the Session ID output from <code class="docutils literal notranslate"><span class="pre">New-PSSession</span></code>:</p>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">Windows/PowerShell</span><a class="headerlink" href="#id7" title="Permalink to this code">¶</a></div>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="p">&gt;</span> <span class="nb">Enter-PSSession</span> <span class="n">-Session</span> <span class="s2">&quot;$SessionId&quot;</span>
</pre></div>
</div>
</div>
<p>Just as with <code class="docutils literal notranslate"><span class="pre">New-PSSession</span></code> there are numerous options that you can read more about <a class="reference external" href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/enter-pssession?view=powershell-7" target="_blank">in this documentation article<i class="fas fa-external-link-alt" aria-hidden="true"></i></a>. In order to exit the interactive session you can use the aptly named <code class="docutils literal notranslate"><span class="pre">Exit-PSSession</span></code>:</p>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">Windows/PowerShell</span><a class="headerlink" href="#id8" title="Permalink to this code">¶</a></div>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="p">&gt;</span> <span class="nb">Exit-PSSession</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="invoke-command">
<h3>10.3.3.3. Invoke-Command<a class="headerlink" href="#invoke-command" title="Permalink to this headline">¶</a></h3>
<p>Entering an interactive session with <code class="docutils literal notranslate"><span class="pre">Enter-PSSession</span></code> allows you to attach to the remote machine and run as many commands as you need. However, because you are working within the remote host machine you will only be able to use files and scripts that already exist on its disk. If you need to run scripts or one-off commands on the remote machine, then the <code class="docutils literal notranslate"><span class="pre">Invoke-Command</span></code> cmdlet is the right tool for the job.</p>
<p><code class="docutils literal notranslate"><span class="pre">Invoke-Command</span></code> gives you the ability to pass in one PowerShell command, or local PowerShell script, you want to execute on the remote Windows machine:</p>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text">Windows/PowerShell</span><a class="headerlink" href="#id9" title="Permalink to this code">¶</a></div>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span>&gt; Invoke-Command -ComputerName 52.55.134.28 -credential student -filepath c:\user\scripts\some-script.ps
</pre></div>
</div>
</div>
<p>The preceding command would run the PowerShell script found at <code class="docutils literal notranslate"><span class="pre">c:\user\scripts\some-script.ps</span></code> on the remote machine at the IP address <code class="docutils literal notranslate"><span class="pre">52.55.134.28</span></code> and using the username <code class="docutils literal notranslate"><span class="pre">student</span></code>. The password for the student role would need to be entered before the script is sent to be run on the remote machine.</p>
</div>
</div>
<div class="section" id="next-step">
<h2>10.3.4. Next Step<a class="headerlink" href="#next-step" title="Permalink to this headline">¶</a></h2>
<p>Now that we have learned about the many remote management mechanisms available to Windows machines we are ready to put them to use. Head over to the Windows Server &amp; IIS deployment walkthrough where we will use RDP to configure and host a simple .NET API!</p>
</div>
</div>



    
    <nav aria-label="Next and Previous Pages">
      <ul class="pager">
        
        <li class="previous"><a href="iis.html"><span aria-hidden="true">&larr;</span> 10.2. Introduction to Web Servers &amp; IIS</a></li>
        
        
        <li class="next"><a href="walkthrough_ws-iis.html">10.4. Walkthrough: Windows Server &amp; IIS Starter App Deployment <span aria-hidden="true">&rarr;</span></a></li>
        
      </ul>
    </nav>
    
    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../../_sources/chapters/ws-iis/remote-management.rst.txt"
     rel="nofollow">Page Source</a>
</div>
      
    </p>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>